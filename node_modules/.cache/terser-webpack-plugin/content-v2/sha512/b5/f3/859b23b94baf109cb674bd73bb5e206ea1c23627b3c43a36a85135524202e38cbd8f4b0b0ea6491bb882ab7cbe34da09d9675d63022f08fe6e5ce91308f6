{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{356:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713220104956.1367a471.png\"},551:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713214925388.76b879c9.png\"},552:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713220509769.580d97e3.png\"},553:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713220605881.438bd7fc.png\"},554:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713220857396.9e2ff925.png\"},555:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713221339022.3f28c642.png\"},556:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713222157190.1c6f2cf6.png\"},557:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713222656562.51b65dd2.png\"},558:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713222757702.525d9646.png\"},559:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713222841951.4df1ed18.png\"},560:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713223041491.5994e7d1.png\"},561:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713223150650.f4e4b411.png\"},562:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713224049419.8f5661e9.png\"},563:function(s,a,t){s.exports=t.p+\"assets/img/image-20210713224245731.e51bc0b3.png\"},923:function(s,a,t){\"use strict\";t.r(a);var e=t(1),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[a(\"p\",[s._v(\"假如我们的服务提供者user-service部署了多个实例，如图：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(551),alt:\"image-20210713214925388\"}})]),s._v(\" \"),a(\"p\",[s._v(\"大家思考几个问题：\")]),s._v(\" \"),a(\"ul\",[a(\"li\",[s._v(\"order-service在发起远程调用的时候，该如何得知user-service实例的ip地址和端口？\")]),s._v(\" \"),a(\"li\",[s._v(\"有多个user-service实例地址，order-service调用时该如何选择？\")]),s._v(\" \"),a(\"li\",[s._v(\"order-service如何得知某个user-service实例是否依然健康，是不是已经宕机？\")])]),s._v(\" \"),a(\"h2\",{attrs:{id:\"_1-eureka的结构和作用\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-eureka的结构和作用\"}},[s._v(\"#\")]),s._v(\" 1.Eureka的结构和作用\")]),s._v(\" \"),a(\"p\",[s._v(\"这些问题都需要利用SpringCloud中的注册中心来解决，其中最广为人知的注册中心就是Eureka，其结构如下：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(356),alt:\"image-20210713220104956\"}})]),s._v(\" \"),a(\"p\",[s._v(\"回答之前的各个问题。\")]),s._v(\" \"),a(\"div\",{staticClass:\"custom-block warning\"},[a(\"p\",{staticClass:\"title\"},[s._v(\"问题1 ：order-service如何得知user-service实例地址？\")])]),a(\"p\",[s._v(\"获取地址信息的流程如下：\")]),s._v(\" \"),a(\"ul\",[a(\"li\",[s._v(\"user-service服务实例启动后，将自己的信息注册到eureka-server（Eureka服务端）。这个叫服务注册\")]),s._v(\" \"),a(\"li\",[s._v(\"eureka-server保存服务名称到服务实例地址列表的映射关系\")]),s._v(\" \"),a(\"li\",[s._v(\"order-service根据服务名称，拉取实例地址列表。这个叫服务发现或服务拉取\")])]),s._v(\" \"),a(\"div\",{staticClass:\"custom-block warning\"},[a(\"p\",{staticClass:\"title\"},[s._v(\"问题2：order-service如何从多个user-service实例中选择具体的实例？\")])]),a(\"ul\",[a(\"li\",[s._v(\"order-service从实例列表中利用负载均衡算法选中一个实例地址\")]),s._v(\" \"),a(\"li\",[s._v(\"向该实例地址发起远程调用\")])]),s._v(\" \"),a(\"div\",{staticClass:\"custom-block warning\"},[a(\"p\",{staticClass:\"title\"},[s._v(\"问题3：order-service如何得知某个user-service实例是否依然健康，是不是已经宕机？\")])]),a(\"ul\",[a(\"li\",[s._v(\"user-service会每隔一段时间（默认30秒）向eureka-server发起请求，报告自己状态，称为心跳\")]),s._v(\" \"),a(\"li\",[s._v(\"当超过一定时间没有发送心跳时，eureka-server会认为微服务实例故障，将该实例从服务列表中剔除\")]),s._v(\" \"),a(\"li\",[s._v(\"order-service拉取服务时，就能将故障实例排除了\")])]),s._v(\" \"),a(\"blockquote\",[a(\"p\",[s._v(\"注意：一个微服务，既可以是服务提供者，又可以是服务消费者，因此eureka将服务注册、服务发现等功能统一封装到了eureka-client端\")])]),s._v(\" \"),a(\"p\",[s._v(\"因此，接下来我们动手实践的步骤包括：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(552),alt:\"image-20210713220509769\"}})]),s._v(\" \"),a(\"h2\",{attrs:{id:\"_2-搭建eureka-server\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-搭建eureka-server\"}},[s._v(\"#\")]),s._v(\" 2.搭建eureka-server\")]),s._v(\" \"),a(\"p\",[s._v(\"首先大家注册中心服务端：eureka-server，这必须是一个独立的微服务\")]),s._v(\" \"),a(\"h3\",{attrs:{id:\"_2-1-创建eureka-server服务\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-1-创建eureka-server服务\"}},[s._v(\"#\")]),s._v(\" 2.1.创建eureka-server服务\")]),s._v(\" \"),a(\"p\",[s._v(\"在cloud-demo父工程下，创建一个子模块：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(553),alt:\"image-20210713220605881\"}})]),s._v(\" \"),a(\"p\",[s._v(\"填写模块信息：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(554),alt:\"image-20210713220857396\"}})]),s._v(\" \"),a(\"p\",[s._v(\"然后填写服务信息：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(555),alt:\"image-20210713221339022\"}})]),s._v(\" \"),a(\"h3\",{attrs:{id:\"_2-2-引入eureka依赖\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-2-引入eureka依赖\"}},[s._v(\"#\")]),s._v(\" 2.2.引入eureka依赖\")]),s._v(\" \"),a(\"p\",[s._v(\"引入\"),a(\"code\",[s._v(\"SpringCloud\")]),s._v(\"为\"),a(\"code\",[s._v(\"eureka\")]),s._v(\"提供的\"),a(\"code\",[s._v(\"starter\")]),s._v(\"依赖：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-xml line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-xml\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dependency\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"groupId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"org.springframework.cloud\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"groupId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"artifactId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"spring-cloud-starter-netflix-eureka-server\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"artifactId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"dependency\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\")])]),a(\"h3\",{attrs:{id:\"_2-3-编写启动类\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-3-编写启动类\"}},[s._v(\"#\")]),s._v(\" 2.3.编写启动类\")]),s._v(\" \"),a(\"p\",[s._v(\"给\"),a(\"code\",[s._v(\"eureka-server\")]),s._v(\"服务编写一个启动类，一定要添加一个\"),a(\"code\",[s._v(\"@EnableEurekaServer\")]),s._v(\"注解，开启eureka的注册中心功能：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-java line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"package\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token namespace\"}},[s._v(\"cn\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"itcast\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"eureka\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"import\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token import\"}},[a(\"span\",{pre:!0,attrs:{class:\"token namespace\"}},[s._v(\"org\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"springframework\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"boot\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")])]),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"SpringApplication\")])]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"import\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token import\"}},[a(\"span\",{pre:!0,attrs:{class:\"token namespace\"}},[s._v(\"org\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"springframework\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"boot\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"autoconfigure\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")])]),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"SpringBootApplication\")])]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"import\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token import\"}},[a(\"span\",{pre:!0,attrs:{class:\"token namespace\"}},[s._v(\"org\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"springframework\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"cloud\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"netflix\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"eureka\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"server\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")])]),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"EnableEurekaServer\")])]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[s._v(\"@SpringBootApplication\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[s._v(\"@EnableEurekaServer\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"public\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"class\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"EurekaApplication\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"public\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"static\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"void\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"main\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"String\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\" args\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"SpringApplication\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"run\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"EurekaApplication\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"class\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\" args\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\")])]),a(\"h3\",{attrs:{id:\"_2-4-编写配置文件\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-4-编写配置文件\"}},[s._v(\"#\")]),s._v(\" 2.4.编写配置文件\")]),s._v(\" \"),a(\"p\",[s._v(\"编写一个\"),a(\"code\",[s._v(\"application.yml\")]),s._v(\"文件，内容如下：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-yaml line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"server\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"port\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"10086\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"spring\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"application\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"name\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" eureka\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"server  \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#eureka得服务名称\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"eureka\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"client\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"service-url\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"  \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#eureka得地址信息\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"defaultZone\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" http\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"//127.0.0.1\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"10086/eureka\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\")])]),a(\"blockquote\",[a(\"p\",[s._v(\"其中第三段是将自己也注册进去，因为自己以后有可能也是一个服务，被别人用到。\")])]),s._v(\" \"),a(\"h3\",{attrs:{id:\"_2-5-启动服务\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-5-启动服务\"}},[s._v(\"#\")]),s._v(\" 2.5.启动服务\")]),s._v(\" \"),a(\"p\",[s._v(\"启动微服务，然后在浏览器访问：\"),a(\"code\",[s._v(\"http://127.0.0.1:10086\")])]),s._v(\" \"),a(\"p\",[s._v(\"看到下面结果应该是成功了：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(556),alt:\"image-20210713222157190\"}})]),s._v(\" \"),a(\"h2\",{attrs:{id:\"_3-服务注册\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-服务注册\"}},[s._v(\"#\")]),s._v(\" 3.服务注册\")]),s._v(\" \"),a(\"p\",[s._v(\"下面，我们将\"),a(\"code\",[s._v(\"user-service\")]),s._v(\"注册到\"),a(\"code\",[s._v(\"eureka-server\")]),s._v(\"中去。\")]),s._v(\" \"),a(\"h3\",{attrs:{id:\"_1-引入依赖\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-引入依赖\"}},[s._v(\"#\")]),s._v(\" 1）引入依赖\")]),s._v(\" \"),a(\"p\",[s._v(\"在\"),a(\"code\",[s._v(\"user-service\")]),s._v(\"的\"),a(\"code\",[s._v(\"pom\")]),s._v(\"文件中，引入下面的\"),a(\"code\",[s._v(\"eureka-client\")]),s._v(\"依赖：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-xml line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-xml\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dependency\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"groupId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"org.springframework.cloud\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"groupId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"artifactId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"spring-cloud-starter-netflix-eureka-client\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"artifactId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"dependency\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\")])]),a(\"h3\",{attrs:{id:\"_2-配置文件\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-配置文件\"}},[s._v(\"#\")]),s._v(\" 2）配置文件\")]),s._v(\" \"),a(\"p\",[s._v(\"在\"),a(\"code\",[s._v(\"user-service\")]),s._v(\"中，修改\"),a(\"code\",[s._v(\"application.yml\")]),s._v(\"文件，添加服务名称、eureka地址：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-yaml line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"spring\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"application\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"name\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" userservice\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"eureka\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"client\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"service-url\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"defaultZone\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" http\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"//127.0.0.1\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"10086/eureka\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\")])]),a(\"h3\",{attrs:{id:\"_3-启动多个user-service实例\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-启动多个user-service实例\"}},[s._v(\"#\")]),s._v(\" 3）启动多个user-service实例\")]),s._v(\" \"),a(\"p\",[s._v(\"为了演示一个服务有多个实例的场景，我们添加一个SpringBoot的启动配置，再启动一个user-service。\")]),s._v(\" \"),a(\"p\",[s._v(\"首先，复制原来的user-service启动配置：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(557),alt:\"image-20210713222656562\"}})]),s._v(\" \"),a(\"p\",[s._v(\"然后，在弹出的窗口中，填写信息：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(558),alt:\"image-20210713222757702\"}})]),s._v(\" \"),a(\"p\",[s._v(\"现在，SpringBoot窗口会出现两个user-service启动配置：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(559),alt:\"image-20210713222841951\"}})]),s._v(\" \"),a(\"p\",[s._v(\"不过，第一个是8081端口，第二个是8082端口。\")]),s._v(\" \"),a(\"p\",[s._v(\"启动两个user-service实例：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(560),alt:\"image-20210713223041491\"}})]),s._v(\" \"),a(\"p\",[s._v(\"查看eureka-server管理页面：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(561),alt:\"image-20210713223150650\"}})]),s._v(\" \"),a(\"h2\",{attrs:{id:\"_4-服务发现\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-服务发现\"}},[s._v(\"#\")]),s._v(\" 4.服务发现\")]),s._v(\" \"),a(\"p\",[s._v(\"下面，我们将order-service的逻辑修改：向\"),a(\"code\",[s._v(\"eureka-server\")]),s._v(\"拉取\"),a(\"code\",[s._v(\"user-service\")]),s._v(\"的信息，实现服务发现。\")]),s._v(\" \"),a(\"h3\",{attrs:{id:\"_1-引入依赖-2\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-引入依赖-2\"}},[s._v(\"#\")]),s._v(\" 1）引入依赖\")]),s._v(\" \"),a(\"p\",[s._v(\"之前说过，服务发现、服务注册统一都封装在\"),a(\"code\",[s._v(\"eureka-client\")]),s._v(\"依赖，因此这一步与服务注册时一致。\")]),s._v(\" \"),a(\"p\",[s._v(\"在order-service的pom文件中，引入下面的eureka-client依赖：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-xml line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-xml\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"dependency\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"groupId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"org.springframework.cloud\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"groupId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"<\")]),s._v(\"artifactId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"spring-cloud-starter-netflix-eureka-client\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"artifactId\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"</\")]),s._v(\"dependency\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\">\")])]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\")])]),a(\"h3\",{attrs:{id:\"_2-配置文件-2\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-配置文件-2\"}},[s._v(\"#\")]),s._v(\" 2）配置文件\")]),s._v(\" \"),a(\"p\",[s._v(\"服务发现也需要知道eureka地址，因此第二步与服务注册一致，都是配置eureka信息：\")]),s._v(\" \"),a(\"p\",[s._v(\"在order-service中，修改application.yml文件，添加服务名称、eureka地址：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-yaml line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"spring\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"application\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"name\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" orderservice\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"eureka\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"client\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"service-url\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"defaultZone\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" http\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"//127.0.0.1\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"10086/eureka\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\")])]),a(\"h3\",{attrs:{id:\"_3-服务拉取和负载均衡\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-服务拉取和负载均衡\"}},[s._v(\"#\")]),s._v(\" 3）服务拉取和负载均衡\")]),s._v(\" \"),a(\"p\",[s._v(\"最后，我们要去eureka-server中拉取user-service服务的实例列表，并且实现负载均衡。\")]),s._v(\" \"),a(\"p\",[s._v(\"不过这些动作不用我们去做，只需要添加一些注解即可。\")]),s._v(\" \"),a(\"p\",[s._v(\"在order-service的OrderApplication中，给RestTemplate这个Bean添加一个@LoadBalanced注解：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(562),alt:\"image-20210713224049419\"}})]),s._v(\" \"),a(\"p\",[s._v(\"修改order-service服务中的cn.itcast.order.service包下的OrderService类中的queryOrderById方法。修改访问的url路径，用服务名代替ip、端口：\")]),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:t(563),alt:\"image-20210713224245731\"}})]),s._v(\" \"),a(\"p\",[s._v(\"spring会自动帮助我们从eureka-server端，根据userservice这个服务名称，获取实例列表，而后完成负载均衡。\")])])}),[],!1,null,null,null);a.default=n.exports}}]);","extractedComments":[]}